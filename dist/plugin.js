(function(l,s,f,o,b,v,F,y){"use strict";function S(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function g(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var c=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,c.get?c:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var E=g(o),i=g(b),r=S(y);const x=o.findByProps("sendMessage"),a=s.persist.ghost;var w=[f.before("sendMessage",x,e=>{e[1].content.search("https://twitter.com")!==-1&&a.enableTwit&&a.changeSentMessages?(e[1].content=e[1].content.replace(/\?.\S*/g,()=>""),e[1].content.replace(/https:\/\/twitter\.com/g,()=>a.fxOrVx)):e[1].content.search("https://youtube.com")!==-1&&a.enableInvidious&&a.changeSentMessages&&e[1].content.replace(/https:\/\/youtube|youtu.be/g,()=>a.invidiousInstance)})];const I=E.find(e=>e.type&&e.type.displayName==="MessageContent"),u=s.persist.ghost,T=/(?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;var M=[f.after("type",I,()=>{const e=document.getElementsByTagName("iframe");for(let t=0;t<e.length;t++){const n=e[t],c=n.getAttribute("src");c.search("https://youtube.com")!==-1&&u.enableInvidious&&u.changeExistingMessages&&n.setAttribute("src",`${u.invidiousInstance}/watch?=${c.match(T)}`)}})];const h=o.findByDisplayName("FormText"),O=o.findByDisplayName("Switch");o.findByDisplayName("TextInput");const j=o.findByDisplayName("Select",!1).SingleSelect,p=e=>({display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:e!==void 0?"1rem":0}),m=({k:e,depends:t,children:n})=>r.default.createElement("div",{style:p(t)},r.default.createElement(O,{checked:s.persist.ghost[e],disabled:t!==void 0&&!s.persist.ghost[t],onChange:c=>s.persist.store[e]=c}),r.default.createElement(h,{children:n})),d=({k:e,options:t,depends:n,children:c})=>r.default.createElement("div",{style:p(n)},r.default.createElement(j,{options:t,value:s.persist.ghost[e],isDisabled:n!==void 0&&!s.persist.ghost[n],onChange:$=>s.persist.store[e]=$}),r.default.createElement(h,{children:c})),N=e=>t=>(v.useNest(s.persist),e(t)),B=(e,t=s.persist)=>{for(const n in e)t.ghost[n]===void 0&&(t.store[n]=e[n])};let k=fetch("https://api.invidious.io/instances.json").then(e=>e.json());B({enableInvidious:!0,invidiousInstance:"https://yewtu.be",enableTwit:!0,fxOrVx:"https://fxtwitter.com",changeSentMessages:!0,changeExistingMessages:!0});var C=N(()=>i.createElement(i.Fragment,null,i.createElement(d,{k:"changeExistingMessages"},"Change links existing embeds"),i.createElement(m,{k:"changeSentMessages"},"Change links of sent messages"),i.createElement(m,{k:"enableInvidious"},"Enable Invidious redirects"),i.createElement(d,{k:"invidiousInstance",depends:"enableInvidious",options:[k.map(e=>({value:`https://${e[0]}`,label:e[0]}))]},"Invidious Instance"),i.createElement(m,{k:"enableTwit"},"Enable Twitter redirects"),i.createElement(d,{k:"fxOrVx",depends:"enableTwit",options:[{value:"https://fxtwitter.com",label:"FxTwitter"},{value:"https://vxtwitter.com",label:"VxTwitter"}]})));const P=[...w,...M],R=()=>_.forEach(P,e=>e());return l.onUnload=R,l.settings=C,Object.defineProperty(l,"__esModule",{value:!0}),l})({},cumcord.pluginData,cumcord.patcher,cumcord.modules.webpack,cumcord.modules.common.React,cumcord.utils,cumcord.plugins,cumcord.modules.common.React);
