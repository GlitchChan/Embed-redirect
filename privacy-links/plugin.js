(function(f,i,h,r,b,E,O,I){"use strict";function S(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function w(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(s){if(s!=="default"){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}}),t.default=e,Object.freeze(t)}var a=w(b),c=S(I);const x=r.findByProps("sendMessage"),u=i.persist.ghost;var C=[h.before("sendMessage",x,e=>{const t=e[1];t.content.search("https://twitter.com")!==-1&&u.enableTwit&&u.twitFixChangeSentLinks?(t.content=t.content.replace(/\?.\S*/g,()=>""),t.content=t.content.replace(/https:\/\/twitter\.com/g,()=>u.twitFixInstance)):t.content.search(/https:\/\/youtube|youtu.be/g)!==-1&&u.enableInvidious&&u.invidiousChangeSentLinks&&(t.content=t.content.replace(/https:\/\/youtube|https:\/\/youtu.be/g,()=>u.invidiousInstance))})];const o=i.persist.ghost,T=r.findByProps("MessageAccessories"),l=/https?:\/\/(w*)\.?(youtube\.com|youtu\.be)/g;var F=[h.after("default",T,(e,t)=>{const s=t.props.message;s.content.search(l)!==-1&&o.invidiousChangeExistingMessages&&o.enableInvidious&&(s.content=s.content.replace(l,()=>o.invidiousInstance)),s.embeds.length>=1&&s.embeds.forEach(n=>{if(n.video&&(n.video.originalURL?n.video.originalURL:n.video.url).includes("youtube")&&o.invidiousChangeExistingMessages&&o.enableInvidious)try{n.provider.url=o.invidiousInstance,n.provider.name="YouTube \u27A1\uFE0F Invidious",n.url=n.url.replace(l,o.invidiousInstance),n.video.url=n.video.url.replace(l,o.invidiousInstance),n.title.url=n.title.url.replace(l,o.invidiousInstance),n.author.url=n.author.url.replace(l,o.invidiousInstance)}catch{}})})];const g=r.findByDisplayName("FormText"),L=r.findByDisplayName("Switch");r.findByDisplayName("TextInput");const M=r.findByDisplayName("Select",!1).SingleSelect,v=e=>({display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:e!==void 0?"1rem":0}),d=({k:e,depends:t,children:s})=>c.default.createElement("div",{style:v(t)},c.default.createElement(L,{checked:i.persist.ghost[e],disabled:t!==void 0&&!i.persist.ghost[t],onChange:n=>i.persist.store[e]=n}),c.default.createElement(g,{children:s})),m=({k:e,options:t,depends:s,children:n})=>c.default.createElement("div",{style:v(s)},c.default.createElement(M,{options:t,value:i.persist.ghost[e],isDisabled:s!==void 0&&!i.persist.ghost[s],onChange:y=>i.persist.store[e]=y}),c.default.createElement(g,{children:n})),j=e=>t=>(E.useNest(i.persist),e(t));((e,t=i.persist)=>{for(const s in e)t.ghost[s]===void 0&&(t.store[s]=e[s])})({enableInvidious:!0,invidiousInstance:"https://yewtu.be",invidiousChangeSentLinks:!1,invidiousChangeExistingMessages:!0,enableTwit:!0,twitFixInstance:"https://fxtwitter.com",twitFixChangeSentLinks:!0}),fetch("https://api.invidious.io/instances.json").then(e=>e.json()).then(e=>e.forEach(t=>{t[0].endsWith(".onion")||p.push({value:`https://${t[0]}`,label:t[0]})}));let p=[];var R=j(()=>a.createElement(a.Fragment,null,a.createElement(d,{k:"enableInvidious"},"Enable Invidious Redirects"),a.createElement(d,{k:"invidiousChangeSentLinks",depends:"enableInvidious"},"Change Sent Links"),a.createElement(d,{k:"invidiousChangeExistingMessages",depends:"enableInvidious"},"Change YouTube Embeds"),a.createElement(m,{k:"invidiousInstance",depends:"enableInvidious",options:p},"Invidious Instance (You may have to reload for this to fully take effect)"),a.createElement(d,{k:"enableTwit"},"Enable Twitter Redirects"),a.createElement(d,{k:"twitFixChangeSentLinks",depends:"enableTwit"},"Change Sent Links"),a.createElement(m,{k:"twitFixInstance",depends:"enableTwit",options:[{value:"https://fxtwitter.com",label:"FxTwitter"},{value:"https://vxtwitter.com",label:"VxTwitter"}]},"Which TwitFix instance should be used")));const k=[...C,...F],B=()=>_.forEach(k,e=>e());return f.onUnload=B,f.settings=R,Object.defineProperty(f,"__esModule",{value:!0}),f})({},cumcord.pluginData,cumcord.patcher,cumcord.modules.webpack,cumcord.modules.common.React,cumcord.utils,cumcord.plugins,cumcord.modules.common.React);
